阅读笔记及问题

# 那么CAS有什么缺点吗？

CAS的缺点主要有3点：
ABA问题：ABA的问题指的是在CAS更新的过程中，当读取到的值是A，然后准备赋值的时候仍然是A，但是实际上有可能A的值被改成了B，然后又被改回了A，这个CAS更新的漏洞就叫做ABA。只是ABA的问题大部分场景下都不影响并发的最终效果。
Java中有AtomicStampedReference来解决这个问题，他加入了预期标志和更新后标志两个字段，更新时不光检查值，还要检查当前的标志是否等于预期标志，全部相等的话才会更新。

循环时间长开销大：自旋CAS的方式如果长时间不成功，会给CPU带来很大的开销。

**？？？只能保证一个共享变量的原子操作：只对一个共享变量操作可以保证原子性，但是多个则不行，多个可以通过AtomicReference来处理或者使用锁synchronized实现。**



# HashMap原理

JDK1.7和1.8的主要区别在于**头插**和**尾插**方式的修改，**头插容易导致HashMap链表死循环**，并且1.8之后加入**红黑树对性能有提升**




# ConcurrentHashmap原理

ConcurrentHashmap在JDK1.7和1.8的版本改动比较大，1.7使用Segment+HashEntry分段锁的方式实现，1.8则抛弃了Segment，改为使用CAS+synchronized+Node实现，同样也加入了红黑树，避免链表过长导致性能的问题




# HashMap常见面试题：

https://mp.weixin.qq.com/s/0Gf2DzuzgEx0i3mHVvhKNQ

HashMap的底层数据结构？

HashMap的存取原理？

Java7和Java8的区别？

为啥会线程不安全？

有什么线程安全的类代替么?

默认初始化大小是多少？为啥是这么多？为啥大小都是2的幂？

HashMap的扩容方式？负载因子是多少？为什是这么多？

HashMap的主要参数都有哪些？

HashMap是怎么处理hash碰撞的？

hash的计算规则？




# object和class两个基础类一样吗？
